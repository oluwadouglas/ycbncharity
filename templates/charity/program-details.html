{% extends 'charity/base.html' %}
{% load static %}

{% block title %}{{ page_title|default:program.title }}{% endblock %}

{% block extra_css %}
<style>
  .program-hero{background:linear-gradient(135deg,#f8fafc,#eef2ff);border-radius:12px}
  .program-hero .lead{color:#475569}
  @media (prefers-color-scheme: dark){.program-hero{background:linear-gradient(135deg,#0b1220,#131c2b)}.program-hero .lead{color:#cbd5e1}}
  .page-img{aspect-ratio:16/9;overflow:hidden;border-radius:12px;background:#f5f5f5}
  .page-img img{width:100%;height:100%;object-fit:cover;display:block}
  .meta{color:#64748b}
  @media (prefers-color-scheme: dark){.meta{color:#94a3b8}}
  .program-card img{aspect-ratio:16/10;object-fit:cover}
  .program-card .card-title{font-weight:700}
  .program-badge{position:absolute;top:.5rem;left:.5rem}
  .btn-soft{background:#f1f5f9;color:#0f172a}
  .btn-soft:hover{background:#e2e8f0}
  @media (prefers-color-scheme: dark){.btn-soft{background:#0f172a;color:#e2e8f0}.btn-soft:hover{background:#111827}}
</style>
{% endblock %}

{% block content %}
<section class="space-top space-extra2-bottom">
  <div class="container">
    <div class="program-hero p-4 p-md-5 mb-5 text-center">
      <h1 class="h3 mb-2">{{ program.title }}</h1>
      <p class="meta mb-0">Category: {{ program.category.name }}</p>
    </div>

    <div class="row gx-40">
      <div class="col-xxl-8 col-lg-7">
        {% if program.image %}
        <div class="page-img position-relative mb-3">
          <img src="{{ program.image.url }}" alt="{{ program.title }}">
        </div>
        {% endif %}

        <div class="blog-content">
          {% if program.description %}
            <p class="mb-45">{{ program.description }}</p>
          {% else %}
            <p class="mb-45">Details coming soon. Check back later for more information about this program.</p>
          {% endif %}

          <a href="{% url 'charity:programs' %}" class="btn btn-outline-primary"><i class="fas fa-arrow-left me-2"></i>Back to Programs</a>
        </div>

        {% if related_programs %}
        <hr class="my-5"/>
        <div class="mb-4 d-flex align-items-center justify-content-between">
          <h4 class="mb-0">Related Programs</h4>
          <a href="{% url 'charity:programs' %}?category={{ program.category.id }}" class="btn btn-sm btn-soft">View all in {{ program.category.name }}</a>
        </div>
        <div class="row">
          {% for rel in related_programs %}
          <div class="col-md-6 col-lg-4 mb-4">
            <div class="card h-100 shadow-sm program-card position-relative">
              <span class="badge bg-primary program-badge">{{ program.category.name }}</span>
              {% if rel.image %}
                <img src="{{ rel.image.url }}" class="card-img-top" alt="{{ rel.title }}">
              {% else %}
                <img src="{% static 'assets/img/placeholder/placeholder-16x10.png' %}" class="card-img-top" alt="{{ rel.title }}">
              {% endif %}
              <div class="card-body">
                <h6 class="card-title mb-2">{{ rel.title }}</h6>
                <p class="card-text mb-0">{{ rel.description|default:"No description yet."|truncatewords:18 }}</p>
              </div>
              <div class="card-footer d-flex justify-content-between align-items-center">
                <a href="{% url 'charity:program_detail' rel.id %}" class="btn btn-sm btn-primary">Learn more</a>
                <a href="{% url 'charity:programs' %}?category={{ rel.category.id }}" class="btn btn-sm btn-soft">Category</a>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
        {% endif %}
      </div>

      <div class="col-xxl-4 col-lg-5 mt-5 mt-lg-0">
        <div class="card shadow-sm">
          <div class="card-body">
            <h5 class="mb-3">Explore Categories</h5>
            <div class="d-flex flex-wrap gap-2">
              {% for cat in categories %}
              <a class="btn btn-sm btn-soft" href="{% url 'charity:programs' %}?category={{ cat.id }}">{{ cat.name }}</a>
              {% empty %}
              <span class="text-muted">No categories available.</span>
              {% endfor %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}
